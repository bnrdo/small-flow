<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
	<div class="row">
		<div class="col-lg-12 margin-top-20">
			<div class="panel panel-default">
				<div class="panel-heading">Cash Inflows</div>
				<!-- /.panel-heading -->
				<div class="panel-body">
					<div>
						<div class="float-left">
							<button type="button" class="btn btn-primary" onclick="newRecord()">
								<i class="glyphicon glyphicon-plus"></i> New
							</button>
							<button type="button" class="btn btn-primary" onclick="editRecord()">
								<i class="glyphicon glyphicon-pencil"></i> Edit
							</button>
							<button type="button" class="btn btn-primary" onclick="deleteRecord()">
								<i class="glyphicon glyphicon-trash"></i> Delete
							</button>
						</div>
						<div class="float-right">
							<button type="button" class="btn btn-default" onclick="loadToTarget('nedip/nedip.do?oper=import', 'page-content')">
								<i class="glyphicon glyphicon-import"></i> Import
							</button>
							<button type="button" class="btn btn-default" onclick="loadToTarget('nedip/nedip.do?oper=import', 'page-content')">
								<i class="glyphicon glyphicon-print"></i> Print
							</button>
						</div>
					</div>
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover"
							id="tbl-cash-inflows">
							<thead>
								<tr>
									<th>Id</th>
									<th>Activity</th>
									<th>Amount</th>
									<th>Date</th>
									<th>Notes</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
					<!-- /.table-responsive -->
				</div>
				<!-- /.panel-body -->
			</div>
			<!-- /.panel -->
		</div>
	</div>

	<!-- Page JavaScript -->
	<script src="js/smf/cash-in.js"></script>

	<!-- DataTables JavaScript -->
	<script src="js/plugins/dataTables/jquery.dataTables.js"></script>
	<script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>
	<script src="http://malsup.github.com/jquery.form.js"></script> 

	<script>
		var selectedRow = null;
		
		function newRecord(){
			loadToTarget('nedip/new.do', 'page-content');
		}
		
		function editRecord(){
			if(selectedRow == null){
				alert("Please select the row you want to edit");
				return;
			}
			
			postJsonAndLoadToTarget('nedip/editOrDelete.do?oper=edit', 'page-content', selectedRow);
		}
		
		function deleteRecord(){
			if(selectedRow == null){
				alert("Please select the row you want to delete");
				return;
			}
			
			postJsonAndLoadToTarget('nedip/editOrDelete.do?oper=delete', 'page-content', selectedRow);
		}
	
		$(document).ready(function() {
			
			var table = $('#tbl-cash-inflows').dataTable({
				lengthChange : false,
				ajax : "read.do",
				bFilter : false,
				columns : [ 
					/* {data : null, render : function(data, type, row) {
						// Combine the first and last names into a single table field
							return data.first_name + ' ' + data.last_name;
						}
					}, */
					{data : "id"},
					{data : "activityIdFk"}, 
					{data : "amount"}, 
					{data : "date"}, 
					{data : "notes"} 
				]
			});
			
			$('#tbl-cash-inflows tbody').on( 'click', 'tr', function () {
		        if ( $(this).hasClass('active') ) {
		            $(this).removeClass('active');
		        }
		        else {
		            table.$('tr.active').removeClass('active');
		            $(this).addClass('active');
		            
		            selectedRow = new Object();
		            
		            selectedRow.id = $(this).find("td:nth-child(1)").text();
		            selectedRow.activityIdFk = $(this).find("td:nth-child(2)").text();
		            selectedRow.amount = $(this).find("td:nth-child(3)").text();
		            selectedRow.date = $(this).find("td:nth-child(4)").text();
		            selectedRow.notes = $(this).find("td:nth-child(5)").text();
		            
		            /* <th>Id</th>
					<th>Activity</th>
					<th>Amount</th>
					<th>Date</th>
					<th>Notes</th> */
		        }
		    } );
		});
	</script>
</body>
</html>